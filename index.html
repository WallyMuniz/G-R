<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Painel de Gerenciamento de Riscos e Oportunidades</title>
  <link rel="icon" href="favicon.ico" type="image/x-icon">


  <style>
    :root{
      --bg:#f4f6f8;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#e5e7eb;

      --blue:#2563eb;
      --ok:#059669;
      --alerta:#d97706;
      --vencido:#dc2626;

      --r:12px;
      --shadow:0 2px 8px rgba(0,0,0,0.08);
      --shadow2:0 10px 22px rgba(0,0,0,0.12);
    }

    *{ box-sizing:border-box; }
    body{
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg);
      margin:0;
      color:var(--text);
    }

    /* ===== TOPBAR (AMBIENTE) ===== */
    .topbar{
      position: sticky;
      top:0;
      z-index: 999;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(6px);
      border-bottom: 1px solid var(--line);
    }
    .topbar-inner{
      max-width: 1200px;
      margin: 0 auto;
      padding: 10px 20px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
      min-width: 0;
    }
    .brand img{
      width: 34px;
      height: 34px;
      object-fit: contain;
      border-radius: 8px;
      background: #fff;
      border: 1px solid rgba(0,0,0,0.06);
    }
    .brand-title{
      display:flex;
      flex-direction:column;
      min-width:0;
    }
    .brand-title strong{
      font-size: 14px;
      line-height: 1.1;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .brand-title span{
      font-size: 12px;
      color: var(--muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .nav{
      display:flex;
      align-items:center;
      gap: 10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }
    .nav a{
      text-decoration:none;
      color:#374151;
      font-size: 13px;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid transparent;
    }
    .nav a:hover{
      background:#f9fafb;
      border-color: rgba(0,0,0,0.06);
    }

    @media (max-width: 740px){
      .nav{ display:none; }
    }

    /* ===== CABEÇALHO (BANNER) ===== */
    .site-header { width:100%; background: var(--card); }
    .site-banner{
      position: relative;
      width:100%;
      height: 260px;
      overflow:hidden;
    }
    .site-banner-bg{
      position:absolute;
      inset:0;
      background-image:url("banner-ame-itapevi.jpg");
      background-size:cover;
      background-position:center;
      background-repeat:no-repeat;
      transform: translate3d(0,0,0);
    }
    .site-banner::after{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(to top, rgba(0,0,0,0.20), rgba(0,0,0,0.00) 58%);
      pointer-events:none;
    }

    /* ===== TÍTULO NO MEIO DO BANNER (VIDRO FOSCO + LEGIBILIDADE) ===== */
    .site-title{
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);

      background: rgb(255 255 255 / 30%);
      backdrop-filter: blur(6px);
      -webkit-backdrop-filter: blur(6px);

      border: 1px solid rgba(255,255,255,0.28);

      padding: 16px 26px;
      border-radius: 8px;

      font-size: 32px;
      font-weight: 800;
      letter-spacing: 2px;

      color: #111827;
      text-shadow: 0 1px 2px rgba(0,0,0,0.25);

      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      z-index: 2;
      text-align: center;
      white-space: nowrap;
    }

    @media (max-width:700px){
      .site-title{
        font-size: 22px;
        padding: 10px 16px;
        letter-spacing: 1.2px;
        white-space: normal;
      }
    }

    /* ===== CONTAINER ===== */
    .container{
      max-width: 1200px;
      margin: 0 auto;
      padding: 16px 20px 26px 20px;
    }

    /* ===== HERO ===== */
    .hero{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
      background: var(--card);
      padding: 16px;
      border-radius: var(--r);
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.03);
      margin-top: -40px; /* efeito “entra no banner” */
      position: relative;
    }
    .hero-text{
      font-size: 26px;
      line-height: 1.45;
      color:#374151;
    }
    .chip-row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-bottom:10px;
    }
    .chip{
      padding:6px 12px;
      border-radius:999px;
      font-weight:700;
      font-size:14px;
      border: 1px solid rgba(0,0,0,0.06);
    }
    .chip-blue{ background:#e0f2fe; color:#075985; }
    .chip-green{ background:#ecfdf5; color:#065f46; }

    .hero h2{
      margin: 0 0 10px 0;
      font-size: 32px;
      color: var(--text);
    }

    /* bloco secundário: não “entra” no banner */
    .hero-secondary{
      margin-top: 12px;
    }

    .hero p{
      margin:0 0 14px 0;
      color:#4b5563;
      text-align: justify;
      text-justify: inter-word;
      font-size: 15px;
    }

    .kpis{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
    }
    .kpi{
      background:#f9fafb;
      border:1px solid var(--line);
      border-radius: 12px;
      padding: 10px 12px;
      min-width: 180px;
    }
    .kpi .label{ font-size: 13px; color: var(--muted); }
    .kpi .value{ font-size: 18px; font-weight: 800; color: var(--text); }

    .hero-image img{
      width:100%;
      height:100%;
      object-fit: contain;
      border-radius: var(--r);
      display:block;
    }
    @media (max-width: 900px){
      .hero{ grid-template-columns: 1fr; margin-top: 12px; }
      .hero-image img{ height: auto; }
    }

    /* ===== SEÇÕES ===== */
    .section-title{
      margin: 18px 0 10px 0;
      font-size: 18px;
      color: #111827;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
    }
    .section-title small{ color: var(--muted); font-weight: normal; }

    .lead{
      margin: 14px 0 0 0;
      color:#4b5563;
      text-align: justify;
      text-justify: inter-word;
      font-size: 15px;
    }

    /* ===== RESUMO + FILTROS ===== */
    .summary{
      display:grid;
      grid-template-columns: repeat(4, minmax(180px, 1fr));
      gap: 12px;
      margin: 14px 0 14px 0;
    }
    .summary-card{
      background: var(--card);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.03);
      padding: 12px 12px;
    }
    .summary-card .slabel{ font-size: 12px; color: var(--muted); }
    .summary-card .svalue{ font-size: 22px; font-weight: 900; margin-top: 6px; }
    .summary-card.ok .svalue{ color: var(--ok); }
    .summary-card.alerta .svalue{ color: var(--alerta); }
    .summary-card.vencido .svalue{ color: var(--vencido); }

    @media (max-width: 900px){
      .summary{ grid-template-columns: repeat(2, minmax(160px, 1fr)); }
    }

    .filters{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 14px;
    }
    .filter-btn{
      border: 1px solid #d1d5db;
      background:#fff;
      border-radius: 999px;
      padding: 8px 12px;
      cursor:pointer;
      font-size: 13px;
    }
    .filter-btn.active{
      border-color: var(--blue);
      box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
    }

    /* ===== BUSCA ===== */
    .toolbar{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      background: var(--card);
      padding: 12px 16px;
      border-radius: var(--r);
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.03);
      margin-bottom: 14px;
    }
    .search-wrap{
      display:flex;
      align-items:center;
      gap:10px;
      width:100%;
    }
    .search-wrap label{
      font-size: 14px;
      color:#374151;
      white-space:nowrap;
    }
    #searchInput{
      flex:1;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      font-size: 14px;
      outline:none;
      transition: box-shadow .15s, border-color .15s;
    }
    #searchInput:focus{
      border-color: var(--blue);
      box-shadow: 0 0 0 3px rgba(37,99,235,0.15);
    }
    #clearBtn{
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      background:#fff;
      cursor:pointer;
      font-size: 14px;
    }
    #resultCount{
      font-size: 13px;
      color: var(--muted);
      white-space: nowrap;
    }

    /* ===== CARDS ===== */
    .cards{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 14px;
    }
    .card{
      background: var(--card);
      border-radius: var(--r);
      padding: 16px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.03);
      transition: transform .12s ease, box-shadow .12s ease;
    }
    .card:hover{
      transform: translateY(-2px);
      box-shadow: var(--shadow2);
    }
    .card h3{
      margin: 0 0 8px 0;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
      color: var(--text);
    }

    .status{
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      color:#fff;
      white-space: nowrap;
      background:#64748b; /* fallback */
    }

    .links{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top: 8px;
    }
    .links a{
      padding: 8px 12px;
      border-radius: 10px;
      background: var(--blue);
      text-decoration:none;
      color:#fff;
      font-size: 14px;
    }

    .meta{
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: var(--r);
      background:#f9fafb;
      border: 1px solid var(--line);
      color:#374151;
      font-size: 13px;
      line-height: 1.35;
    }
    .meta-row{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 10px;
    }

    .badge{
      display:inline-block;
      padding: 3px 8px;
      border-radius: 999px;
      color:#fff;
      font-size: 12px;
      white-space: nowrap;
      background:#64748b; /* fallback */
    }
    .badge-ok{ background: var(--ok); }
    .badge-alerta{ background: var(--alerta); }
    .badge-vencido{ background: var(--vencido); }

    #noResults{
      display:none;
      margin-top: 14px;
      background: var(--card);
      padding: 16px;
      border-radius: var(--r);
      box-shadow: var(--shadow);
      color: var(--muted);
      border: 1px solid rgba(0,0,0,0.03);
    }

    footer{
      margin-top: 34px;
      font-size: 13px;
      color: var(--muted);
    }

    @media (prefers-reduced-motion: reduce){
      *{ transition:none !important; }
    }
  </style>
</head>

<body>

  <!-- ===== TOPBAR ===== -->
  <div class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <img src="logo-ame.png" alt="Logo AME" />
        <div class="brand-title">
          <strong>AME - Itapevi</strong>
          <span>Gerenciamento de Riscos e Oportunidades</span>
        </div>
      </div>

      <nav class="nav">
        <a href="#visao-geral">Visão geral</a>
        <a href="#areas">Áreas</a>
        <a href="#sobre">Sobre</a>
      </nav>
    </div>
  </div>

  <!-- ===== BANNER ===== -->
  <header class="site-header">
    <div class="site-banner">
      <div class="site-banner-bg"></div>
      <div class="site-title">G&amp;R AME – ITAPEVI</div>
    </div>
  </header>

  <div class="container">

    <!-- ===== HERO ===== -->
    <section id="visao-geral" class="hero">
      <div class="hero-text">
        <div class="chip-row">
          <span class="chip chip-blue">Painel G&amp;R</span>
          <span class="chip chip-green">Revisão semestral</span>
        </div>

        <h2>Visão geral</h2>

        <p>
          Este painel tem como objetivo centralizar, de forma organizada e transparente, os documentos oficiais de Gerenciamento de Riscos e Oportunidades das áreas do AME Itapevi. A ferramenta permite o acompanhamento sistemático dos prazos de revisão, com identificação automática do status de cada documento (OK, ALERTA ou VENCIDO), apoiando a tomada de decisão, o planejamento das ações corretivas e a governança dos processos. Dessa forma, o painel contribui para o fortalecimento da cultura de qualidade, segurança e melhoria contínua na unidade.
        </p>

        <div class="kpis">
          <div class="kpi">
            <div class="label">⏳ Periodicidade</div>
            <div class="value">6 meses</div>
          </div>
          <div class="kpi">
            <div class="label">⚠️ Critério de alerta</div>
            <div class="value">30 dias</div>
          </div>
          <div class="kpi">
            <div class="label">✅ Acesso</div>
            <div class="value">PDF oficial</div>
          </div>
        </div>
      </div>

      <div class="hero-image">
        <img src="CORPO.PNG" alt="Imagem de apoio" />
      </div>
    </section>

    <p class="lead">
      Centralização dos acessos aos Gerenciamentos de Riscos e Oportunidades por área da unidade.
    </p>

    <!-- ===== RESUMO ===== -->
    <div class="section-title">
      <div>Resumo do painel <small>(contagem automática)</small></div>
    </div>

    <div class="summary">
      <div class="summary-card">
        <div class="slabel">Total de áreas</div>
        <div class="svalue" id="sumTotal">0</div>
      </div>
      <div class="summary-card ok">
        <div class="slabel">OK</div>
        <div class="svalue" id="sumOk">0</div>
      </div>
      <div class="summary-card alerta">
        <div class="slabel">ALERTA</div>
        <div class="svalue" id="sumAlerta">0</div>
      </div>
      <div class="summary-card vencido">
        <div class="slabel">VENCIDO</div>
        <div class="svalue" id="sumVencido">0</div>
      </div>
    </div>

    <div class="filters" aria-label="Filtros de status">
      <button class="filter-btn active" type="button" data-filter="ALL">Todos</button>
      <button class="filter-btn" type="button" data-filter="OK">OK</button>
      <button class="filter-btn" type="button" data-filter="ALERTA">ALERTA</button>
      <button class="filter-btn" type="button" data-filter="VENCIDO">VENCIDO</button>
    </div>

    <!-- ===== BUSCA ===== -->
    <div class="toolbar">
      <div class="search-wrap">
        <label for="searchInput"><strong>Pesquisar área:</strong></label>
        <input id="searchInput" type="text" placeholder="Ex.: Enfermagem, Faturamento, Segurança..." />
        <button id="clearBtn" type="button">Limpar</button>
      </div>
      <div id="resultCount"></div>
    </div>

    <section id="areas">
      <div class="section-title">
        <div>Áreas <small>(documentos oficiais)</small></div>
      </div>



      <div class="cards" id="cardsContainer">

        <!-- 1. Atendimento -->
        <div class="card" data-area="Atendimento" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Atendimento <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="1. Gerenciamento de Riscos e Oportunidades - Atendimento.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 2. Agendamento -->
        <div class="card" data-area="Agendamento" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Agendamento <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="2. Gerenciamento de Riscos e Oportunidades - Agendamento.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
              
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 3. Segurança do Trabalho -->
        <div class="card" data-area="Segurança do Trabalho" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Segurança do Trabalho <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="3. Gerenciamento de Riscos e Oportunidades - Segurança Trabalho.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
              
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 4. Facilities -->
        <div class="card" data-area="Facilities" data-revisao="2025-09-29" data-entrega="2025-09-26">
          <h3>Facilities <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="4. Gerenciamento de Riscos e Oportunidades - Facilities.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
              
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 5. Suprimentos -->
        <div class="card" data-area="Suprimentos" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Suprimentos <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="5. Gerenciamento de Riscos e Oportunidades - Suprimentos.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
             
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 6. Serviço Social -->
        <div class="card" data-area="Serviço Social" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Serviço Social <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="6. Gerenciamento de Riscos e Oportunidades - Serviço Social.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
             
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 7. Controladoria -->
        <div class="card" data-area="Controladoria" data-revisao="2025-09-25" data-entrega="2025-09-24">
          <h3>Controladoria <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="7. Gerenciamento de Riscos e Oportunidades - Controladoria.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
              
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 8. Faturamento -->
        <div class="card" data-area="Faturamento" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Faturamento <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="8. Gerenciamento de Riscos e Oportunidades - Faturamento.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
              
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 9. Área Médica -->
        <div class="card" data-area="Área Médica" data-revisao="2025-09-26" data-entrega="2025-09-25">
          <h3>Área Médica <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="9. Gerenciamento de Riscos e Oportunidades - Área Médica.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
             
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

        <!-- 10. Enfermagem -->
        <div class="card" data-area="Enfermagem" data-revisao="2025-09-29" data-entrega="2025-09-26">
          <h3>Enfermagem <span class="status">G&amp;R</span></h3>
          <div class="links">
            <a href="10. Gerenciamento de Riscos e Oportunidades - Enfermagem.pdf" target="_blank">Documento oficial</a>
          </div>
          <div class="meta">
            <div class="meta-row">
              <div><strong>Revisão realizada em:</strong> <span class="last-review"></span></div>
             
            </div>
            <div><strong>Próxima revisão (6 meses):</strong> <span class="next-review"></span></div>
            <div><strong>Data de entrega:</strong> <span class="delivery-date"></span></div>
          </div>
        </div>

      </div>

      <div id="noResults">
        Nenhuma área encontrada com esse termo. Verifique a grafia ou tente outro nome.
      </div>
    </section>

    <section id="sobre">
      <div class="section-title">
        <div>Sobre <small>(governança do painel)</small></div>
      </div>

      <!-- ===== BLOCO: IMAGEM À ESQUERDA + TEXTO À DIREITA ===== -->
      <div class="hero hero-secondary">
        <div class="hero-image">
          <img src="Gerenciamento.PNG" alt="Gerenciamento de Riscos e Oportunidades">
        </div>

        <div class="hero-text">
          <h2>Gerenciamento de Riscos e Oportunidades</h2>

          <p>
            O Gerenciamento de Riscos e Oportunidades no AME – Ambulatório Médico de Especialidades
            é um instrumento fundamental para a identificação, análise e mitigação de riscos que
            possam impactar a assistência, a segurança do paciente e a continuidade dos serviços.
            Alinhado às diretrizes da Organização Pan-Americana da Saúde (OPAS), esse processo
            contribui para o fortalecimento da cultura de qualidade, da governança institucional
            e da melhoria contínua dos processos assistenciais e administrativos.
          </p>

          <p>
            No contexto do AME, esse gerenciamento é realizado de forma integrada, com a participação
            de todas as áreas da unidade, promovendo a cultura de segurança, o engajamento das equipes
            e a tomada de decisão baseada em evidências. Dessa forma, a unidade reafirma seu compromisso
            com uma assistência segura, humanizada e alinhada às boas práticas de governança em saúde.
          </p>
        </div>
      </div>


      <div class="meta">      
        <div><strong>Responsável técnico:</strong> Gestão de Qualidade – Wally Silva de Jesus</div>
        <div><strong>Última atualização:</strong> 12/12/2025</div>
        <div style="margin-top:8px;color:var(--muted);">
          Este painel centraliza os acessos aos documentos oficiais por área e calcula automaticamente o status de prazo
          conforme periodicidade de 6 meses e alerta em 30 dias.
        </div>
      </div>
    </section>

    <footer>
      © AME Itapevi – Painel de Gerenciamento de Riscos e Oportunidades
    </footer>

  </div>

<script>
(function () {
  // ===== SCROLL SUAVE NO MENU =====
  const topbar = document.querySelector('.topbar');
  document.querySelectorAll('.nav a[href^="#"]').forEach(link => {
    link.addEventListener('click', (e) => {
      const id = link.getAttribute('href');
      const target = document.querySelector(id);
      if (!target) return;

      e.preventDefault();
      const top = target.getBoundingClientRect().top + window.pageYOffset;
      const offset = (topbar ? topbar.offsetHeight : 0) + 10;
      window.scrollTo({ top: top - offset, behavior: 'smooth' });
    });
  });

  // ===== GOOGLE SHEETS -> PAINEL =====
  const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQKR0ek618-XQO7zpdxYuAiYD78mfmhiFtOyIrfyuZgMhUetNKFtV3GzRpfUEO1orwKL7ZVKIW8MsFF/pub?output=csv";
  const ALERT_DAYS = 30;

  function normalize(text) {
    return (text || "")
      .toString()
      .toLowerCase()
      .normalize("NFD")
      .replace(/[\u0300-\u036f]/g, "")
      .trim();
  }

  function parseCSV(csvText) {
    const rows = [];
    let row = [];
    let cur = "";
    let inQuotes = false;

    for (let i = 0; i < csvText.length; i++) {
      const ch = csvText[i];
      const next = csvText[i + 1];

      if (ch === '"' && inQuotes && next === '"') { cur += '"'; i++; continue; }
      if (ch === '"') { inQuotes = !inQuotes; continue; }

      if (ch === "," && !inQuotes) { row.push(cur); cur = ""; continue; }

      if ((ch === "\n" || ch === "\r") && !inQuotes) {
        if (cur.length || row.length) { row.push(cur); rows.push(row); }
        row = []; cur = "";
        if (ch === "\r" && next === "\n") i++;
        continue;
      }
      cur += ch;
    }

    if (cur.length || row.length) { row.push(cur); rows.push(row); }
    return rows;
  }

  function toISODateString(value) {
    const v = (value || "").trim();
    if (!v) return "";

    if (/^\d{4}-\d{2}-\d{2}$/.test(v)) return v;

    const m = v.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);
    if (m) return `${m[3]}-${m[2]}-${m[1]}`;

    return "";
  }

  function parseISODate(iso) {
    if (!iso) return null;
    const [y, m, d] = iso.split("-").map(Number);
    if (!y || !m || !d) return null;
    return new Date(y, m - 1, d);
  }

  function formatBR(date) {
    if (!date) return "—";
    const dd = String(date.getDate()).padStart(2, "0");
    const mm = String(date.getMonth() + 1).padStart(2, "0");
    const yyyy = date.getFullYear();
    return `${dd}/${mm}/${yyyy}`;
  }

  function addMonths(date, months) {
    const d = new Date(date.getTime());
    const day = d.getDate();
    d.setMonth(d.getMonth() + months);
    if (d.getDate() < day) d.setDate(0);
    return d;
  }

  function daysBetween(a, b) {
    const ms = 24 * 60 * 60 * 1000;
    return Math.ceil((b - a) / ms);
  }

  const cards = Array.from(document.querySelectorAll(".card"));

  async function loadSheetAndApply() {
    const sheetMap = new Map();

    try {
      const res = await fetch(SHEET_CSV_URL, { cache: "no-store" });
      if (!res.ok) throw new Error("Falha ao baixar CSV: " + res.status);
      const csvText = await res.text();

      const rows = parseCSV(csvText);
      if (!rows.length) throw new Error("CSV vazio.");

      const headers = rows[0].map(h => normalize(h));
      const idxArea = headers.indexOf("area");
      const idxRev  = headers.indexOf("revisao");
      const idxEnt  = headers.indexOf("entrega");

      if (idxArea < 0 || idxRev < 0 || idxEnt < 0) {
        throw new Error("Cabeçalho inválido. Precisa: area, revisao, entrega.");
      }

      for (let i = 1; i < rows.length; i++) {
        const r = rows[i];
        const area = normalize(r[idxArea]);
        if (!area) continue;

        sheetMap.set(area, {
          revisaoISO: toISODateString(r[idxRev]),
          entregaISO: toISODateString(r[idxEnt])
        });
      }
    } catch (e) {
      console.warn("Não consegui carregar a planilha. Vou usar os dados do HTML.", e);
      return; // mantém o HTML como fallback
    }

    cards.forEach(card => {
      const areaKey = normalize(card.getAttribute("data-area"));
      const row = sheetMap.get(areaKey);
      if (!row) return;
      if (row.revisaoISO) card.setAttribute("data-revisao", row.revisaoISO);
      if (row.entregaISO) card.setAttribute("data-entrega", row.entregaISO);
    });
  }

  function calcStatusAndRender() {
    const root = getComputedStyle(document.documentElement);

    cards.forEach(card => {
      const last = parseISODate(card.getAttribute("data-revisao"));
      const delivery = parseISODate(card.getAttribute("data-entrega"));

      const lastEl = card.querySelector(".last-review");
      const nextEl = card.querySelector(".next-review");
      const delEl  = card.querySelector(".delivery-date");
      const badgeEl = card.querySelector(".status-review");
      const pillEl = card.querySelector(".status");

      if (lastEl) lastEl.textContent = formatBR(last);
      if (delEl)  delEl.textContent  = formatBR(delivery);

      let statusText = "SEM DATA";

      if (!last) {
        if (nextEl) nextEl.textContent = "—";
        card.setAttribute("data-status", statusText);

        if (badgeEl) {
          badgeEl.textContent = statusText;
          badgeEl.className = "badge badge-vencido status-review";
        }
        if (pillEl) {
          pillEl.textContent = "G&R";
          pillEl.style.background = "#64748b";
        }
        return;
      }

      const next = addMonths(last, 6);
      if (nextEl) nextEl.textContent = formatBR(next);

      const today = new Date();
      today.setHours(0,0,0,0);
      next.setHours(0,0,0,0);

      const diff = daysBetween(today, next);

      if (diff < 0) statusText = "VENCIDO";
      else if (diff <= ALERT_DAYS) statusText = "ALERTA";
      else statusText = "OK";

      card.setAttribute("data-status", statusText);

      if (badgeEl) {
        if (statusText === "VENCIDO") {
          badgeEl.textContent = "VENCIDO";
          badgeEl.className = "badge badge-vencido status-review";
        } else if (statusText === "ALERTA") {
          badgeEl.textContent = "ALERTA";
          badgeEl.className = "badge badge-alerta status-review";
        } else {
          badgeEl.textContent = "OK";
          badgeEl.className = "badge badge-ok status-review";
        }
      }

      if (pillEl) {
        pillEl.textContent = statusText;
        if (statusText === "VENCIDO") pillEl.style.background = root.getPropertyValue('--vencido');
        else if (statusText === "ALERTA") pillEl.style.background = root.getPropertyValue('--alerta');
        else pillEl.style.background = root.getPropertyValue('--ok');
      }
    });
  }

  function updateSummary(visibleCards){
    let ok = 0, alerta = 0, vencido = 0;

    visibleCards.forEach(c=>{
      const s = c.getAttribute("data-status");
      if (s === "OK") ok++;
      else if (s === "ALERTA") alerta++;
      else if (s === "VENCIDO") vencido++;
    });

    document.getElementById("sumTotal").textContent = visibleCards.length;
    document.getElementById("sumOk").textContent = ok;
    document.getElementById("sumAlerta").textContent = alerta;
    document.getElementById("sumVencido").textContent = vencido;
  }

  const input = document.getElementById('searchInput');
  const clearBtn = document.getElementById('clearBtn');
  const resultCount = document.getElementById('resultCount');
  const noResults = document.getElementById('noResults');
  const filterBtns = Array.from(document.querySelectorAll(".filter-btn"));
  let activeFilter = "ALL";

  function applyFilters(){
    const term = normalize(input.value.trim());
    let visible = 0;
    const visibleCards = [];

    cards.forEach(card => {
      const area = normalize(card.getAttribute('data-area'));
      const status = card.getAttribute("data-status") || "";
      const matchText = (term === "" || area.includes(term));
      const matchStatus = (activeFilter === "ALL" || status === activeFilter);

      const show = matchText && matchStatus;
      card.style.display = show ? "" : "none";

      if (show){
        visible++;
        visibleCards.push(card);
      }
    });

    resultCount.textContent = visible + " área(s) exibida(s)";
    noResults.style.display = (visible === 0) ? "block" : "none";
    updateSummary(visibleCards);
  }

  clearBtn.addEventListener('click', function () {
    input.value = "";
    input.focus();
    applyFilters();
  });

  input.addEventListener('input', applyFilters);

  filterBtns.forEach(btn=>{
    btn.addEventListener("click", ()=>{
      filterBtns.forEach(b=>b.classList.remove("active"));
      btn.classList.add("active");
      activeFilter = btn.getAttribute("data-filter");
      applyFilters();
    });
  });

  (async function init(){
    await loadSheetAndApply();
    calcStatusAndRender();
    applyFilters();
  })();
})();
</script>

</body>
</html>